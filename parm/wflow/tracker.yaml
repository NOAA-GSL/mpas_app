workflow:
  tasks:
    task_tracker:
      command:
        cyclestr:
          value: 'source &MPAS_APP;/load_wflow_modules.sh &PLATFORM; &&
            cd {{ user.experiment_dir }}/@Y@m@d@H &&
            &MPAS_APP;/scripts/run_tracker.sh @Y@m@d@H'
      account: "{{ platform.account }}"
      join:
        cyclestr:
          value: '&LOGDIR;/{{ jobname }}_@Y@m@d@H.log'
      walltime: "{{ tracker.execution.batchargs.walltime }}"
      nodes: "{{ tracker.execution.batchargs.nodes }}:ppn={{ tracker.execution.batchargs.tasks_per_node }}"
      exclusive: "True"
      partition: "{{ post.upp.execution.batchargs.partition }}"
      envars:
        TRACKER_DIR:
          cyclestr:
            value: '{{ tracker.execution.tracker_dir }}'
        MPISERIAL:
          cyclestr:
            value: '{{ tracker.execution.mpiserial }}'
        SYNDAT_PREFIX:
          cyclestr:
            value: '{{ tracker.execution.syndat_prefix }}'
        MPICMD:
          cyclestr:
            value: '{{ tracker.execution.mpicmd }}'
        FHOUR_STEP:
          cyclestr:
            value: '{{ tracker.execution.fhour_step }}'
        FORECAST_LENGTH:
          cyclestr:
            value: '{{ forecast.mpas.length }}'
      dependency:
        metataskdep:
          attrs:
            metatask: post
